{
  "network_configuration": {
    "default_compartment_id"          : "CUSTOMER-1-DEV-CMP",
    "default_enable_cis_checks"       : true,

    "network_configuration_categories": {
      "production": {
        "vcns"                     : {
          "THREE-TIER-VCN": {
            "display_name"                    : "three-tier-vcn",
            "block_nat_traffic"               : false,
            "dns_label"                       : "threetiervcn",
            "is_ipv6enabled"                  : false,
            "is_oracle_gua_allocation_enabled": false,

            "cidr_blocks"                     : [
              "10.0.0.0/26"
            ],

            "network_security_groups"         : {
              "THREE-TIER-VCN-APP-NSG"      : {
                "display_name" : "app-nsg",

                "egress_rules" : {
                  "TO-ANYWHERE": {
                    "description": "Egress to anywhere.",
                    "protocol"   : "TCP",
                    "dst"        : "0.0.0.0/0",
                    "dst_type"   : "CIDR_BLOCK",
                    "stateless"  : false
                  }
                },

                "ingress_rules": {
                  "FROM-LBR-NSG": {
                    "description" : "Ingress from LBR NSG",
                    "protocol"    : "TCP",
                    "dst_port_max": 80,
                    "dst_port_min": 80,
                    "src"         : "THREE-TIER-VCN-LBR-NSG",
                    "src_type"    : "NETWORK_SECURITY_GROUP",
                    "stateless"   : false
                  }
                }
              },

              "THREE-TIER-VCN-DB-NSG"       : {
                "display_name" : "db-nsg",

                "egress_rules" : {
                  "TO-ANYWHERE": {
                    "description": "Egress to anywhere.",
                    "protocol"   : "TCP",
                    "dst"        : "0.0.0.0/0",
                    "dst_type"   : "CIDR_BLOCK",
                    "stateless"  : false
                  }
                },

                "ingress_rules": {
                  "FROM-APP-NSG": {
                    "description" : "Ingress from App NSG",
                    "protocol"    : "TCP",
                    "dst_port_max": 1522,
                    "dst_port_min": 1521,
                    "src"         : "THREE-TIER-VCN-APP-NSG",
                    "src_type"    : "NETWORK_SECURITY_GROUP",
                    "stateless"   : false
                  }
                }
              },

              "THREE-TIER-VCN-JUMP-HOST-NSG": {
                "display_name" : "jump-host-nsg",

                "ingress_rules": {
                  "FROM-ON-PREM-SSH": {
                    "description" : "Ingress from Central Hub VCN's Bastion subnet.",
                    "protocol"    : "TCP",
                    "dst_port_max": 22,
                    "dst_port_min": 22,
                    "src"         : "192.168.0.32/29",
                    "src_type"    : "CIDR_BLOCK",
                    "stateless"   : false
                  }
                }
              },

              "THREE-TIER-VCN-LBR-NSG"      : {
                "display_name" : "lbr-nsg",

                "egress_rules" : {
                  "TO-ANYWHERE": {
                    "description": "Egress to anywhere.",
                    "protocol"   : "TCP",
                    "dst"        : "0.0.0.0/0",
                    "dst_type"   : "CIDR_BLOCK",
                    "stateless"  : false
                  }
                },

                "ingress_rules": {
                  "FROM-ANYWHERE-HTTPS": {
                    "description" : "Ingress from 0.0.0.0/0 on HTTP port 443.",
                    "protocol"    : "TCP",
                    "dst_port_max": 443,
                    "dst_port_min": 443,
                    "src"         : "0.0.0.0/0",
                    "src_type"    : "CIDR_BLOCK",
                    "stateless"   : false
                  }
                }
              }
            },

            "route_tables"                    : {
              "THREE-TIER-VCN-ROUTE": {
                "display_name": "generic-route-table",

                "route_rules" : {
                  "DRG-RULE": {
                    "description"       : "All traffic goes to DRG.",
                    "destination"       : "0.0.0.0/0",
                    "destination_type"  : "CIDR_BLOCK",
                    "network_entity_key": "CENTRAL-HUB-DRG"
                  }
                }
              }
            },

            "subnets"                         : {
              "THREE-TIER-VCN-APP-SUBNET": {
                "display_name"             : "app-subnet",
                "cidr_block"               : "10.0.0.0/27",
                "dhcp_options_key"         : "default_dhcp_options",
                "dns_label"                : "app",
                "prohibit_internet_ingress": true,
                "route_table_key"          : "THREE-TIER-VCN-ROUTE",
                "ipv6cidr_blocks"          : []
              },

              "THREE-TIER-VCN-DB-SUBNET" : {
                "display_name"             : "db-subnet",
                "cidr_block"               : "10.0.0.40/29",
                "dhcp_options_key"         : "default_dhcp_options",
                "dns_label"                : "db",
                "prohibit_internet_ingress": true,
                "route_table_key"          : "THREE-TIER-VCN-ROUTE",
                "ipv6cidr_blocks"          : []
              },

              "THREE-TIER-VCN-WEB-SUBNET": {
                "display_name"             : "web-subnet",
                "cidr_block"               : "10.0.0.32/29",
                "dhcp_options_key"         : "default_dhcp_options",
                "dns_label"                : "web",
                "prohibit_internet_ingress": true,
                "route_table_key"          : "THREE-TIER-VCN-ROUTE",
                "ipv6cidr_blocks"          : []
              }
            }
          }
        },

        "non_vcn_specific_gateways": {
          "inject_into_existing_drgs": {
            "CUSTOMER-1-THREE-TIER-CENTRAL-HUB-DRG-INJECT": {
              "drg_id"                 : "CENTRAL-HUB-DRG",

              "drg_attachments"        : {
                "CUSTOMER-1-THREE-TIER-VCN-ATTACH": {
                  "display_name"       : "customer1-three-tier-vcn-attachment",
                  "drg_route_table_key": "CUSTOMER-1-THREE-TIER-VCN-DRG-ROUTE",

                  "network_details"    : {
                    "type"                 : "VCN",
                    "attached_resource_key": "THREE-TIER-VCN"
                  }
                }
              },

              "drg_route_distributions": {
                "CUSTOMER-1-THREE-TIER-VCN-IMPORT-ROUTE-DISTRIBUTION": {
                  "display_name"     : "customer1-three-tier-vcn-route-distribution",
                  "distribution_type": "IMPORT",

                  "statements"       : {
                    "CUSTOMER-1-THREE-TIER-VCN-TO-CENTRAL-HUB-VCN-STMT": {
                      "action"        : "ACCEPT",
                      "priority"      : 1,

                      "match_criteria": {
                        "attachment_type"   : "VCN",
                        "drg_attachment_key": "CENTRAL-HUB-VCN-ATTACH",
                        "match_type"        : "DRG_ATTACHMENT_ID"
                      }
                    }
                  }
                }
              },

              "drg_route_tables"       : {
                "CUSTOMER-1-THREE-TIER-VCN-DRG-ROUTE": {
                  "display_name"                     : "customer1-three-tier-drg-route-table",
                  "import_drg_route_distribution_key": "CUSTOMER-1-THREE-TIER-VCN-IMPORT-ROUTE-DISTRIBUTION"
                }
              }
            }
          }
        }
      }
    }
  }
}
