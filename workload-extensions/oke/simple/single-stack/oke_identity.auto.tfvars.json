{
    "compartments_configuration": {
        "compartments": {
            "CMP-LANDINGZONE-KEY": {
                "children": {
                    "CMP-LZ-NETWORK-KEY": {
                        "defined_tags": {
                            "tagns-lz-role.tag-lz-role"           : "lz-network-admin"
                        },
                        "description"                             : "Shared Network Compartment",
                        "name"                                    : "cmp-lz-network"
                    },

                    "CMP-LZ-PLATFORM-KEY": {
                        "description"                             : "Shared Platform Compartment",
                        "name"                                    : "cmp-lz-platform"
                    },

                    "CMP-LZ-PREPROD-KEY": {
                        "children": {
                            "CMP-LZ-PREPROD-NETWORK-KEY": {
                                "defined_tags": {
                                    "tagns-lz-role.tag-lz-role"   : "lz-network-admin"
                                },
                                "description"                     : "Pre-Production Workload Environment, Common Network Compartment",
                                "name"                            : "cmp-lz-preprod-network"
                            },

                            "CMP-LZ-PREPROD-PLATFORM-KEY": {
                                "description"                     : "Pre-Production Workload Environment, Common Platform Compartment",
                                "name"                            : "cmp-lz-preprod-platform"
                            },

                            "CMP-LZ-PREPROD-PROJECTS-KEY": {
                                "children": {
                                    "CMP-LZ-PREPROD-PROJ1-KEY": {
                                        "description"             : "Pre-Production environment, Project 1 compartment",
                                        "name"                    : "cmp-lz-preprod-proj1"
                                    }
                                },
                                "description"                     : "One-OE Pre-Production Workload Environment, Common Projects Compartment",
                                "name"                            : "cmp-lz-preprod-projects"
                            },

                            "CMP-LZ-PREPROD-SECURITY-KEY": {
                                "defined_tags": {
                                    "tagns-lz-role.tag-lz-role"   : "lz-security-admin"
                                },
                                "description"                     : "Pre-Production Workload Environment, Common Security Compartment",
                                "name"                            : "cmp-lz-preprod-security"
                            }
                        },
                        "description"                             : "Pre-Production Environment Compartment",
                        "name"                                    : "cmp-lz-preprod"
                    },

                    "CMP-LZ-PROD-KEY": {
                        "children": {
                            "CMP-LZ-PROD-NETWORK-KEY": {
                                "defined_tags": {
                                    "tagns-lz-role.tag-lz-role"   : "lz-network-admin"
                                },
                                "description"                     : "Prod Workload Environment, Common Network Compartment",
                                "name"                            : "cmp-lz-prod-network"
                            },

                            "CMP-LZ-PROD-PLATFORM-KEY": {
                                "children": {
                                    "CMP-LZ-PROD-PLATFORM-OKE-KEY": {
                                        "description"             : "Platform compartment for oke Prod related resources",
                                        "name"                    : "cmp-lz-prod-platform-oke"
                                    }
                                },
                                "description"                     : "Production Workload Environment, Common Platform Compartment",
                                "name"                            : "cmp-lz-prod-platform"
                            },

                            "CMP-LZ-PROD-PROJECTS-KEY": {
                                "children": {
                                    "CMP-LZ-PROD-PROJ1-KEY": {
                                        "description"             : "Production environment, Project 1 Compartment",
                                        "name"                    : "cmp-lz-prod-proj1"
                                    }
                                },
                                "description"                     : "One-OE Production Workload Environment, Common Projects Compartment",
                                "name"                            : "cmp-lz-prod-projects"
                            },

                            "CMP-LZ-PROD-SECURITY-KEY": {
                                "defined_tags": {
                                    "tagns-lz-role.tag-lz-role"   : "lz-security-admin"
                                },
                                "description"                     : "Production Workload Environment, Common Security Compartment",
                                "name"                            : "cmp-lz-prod-security"
                            }
                        },
                        "description"                             : "Production Environment Compartment",
                        "name"                                    : "cmp-lz-prod"
                    },

                    "CMP-LZ-SECURITY-KEY": {
                        "defined_tags": {
                            "tagns-lz-role.tag-lz-role"           : "lz-security-admin"
                        },
                        "description"                             : "Shared Security Compartment",
                        "name"                                    : "cmp-lz-security"
                    }
                },
                "description"                                     : "Enclosing Production Landing Zone Compartment",
                "name"                                            : "cmp-landingzone"
            }
        },
        "enable_delete"                                           : "true"
    },

    "groups_configuration": {
        "groups": {
            "GRP-LZ-PROD-PLATFORM-OKE-ADMINS-KEY": {
                "description"                                     : "Prod OKE Cluster Management Admin",
                "name"                                            : "grp-lz-prod-platform-oke-admins"
            },

            "GRP-LZ-PROD-PLATFORM-OKE-RBAC-ADMIN-KEY": {
                "description"                                     : "Prod OKE RBAC Admin",
                "name"                                            : "grp-lz-prod-platform-oke-rbac-admin"
            },

            "GRP-LZ-PROD-PLATFORM-OKE-RBAC-VIEWER-KEY": {
                "description"                                     : "Prod OKE RBAC Viewer",
                "name"                                            : "grp-lz-prod-platform-oke-rbac-viewer"
            }
        }
    },

    "identity_domain_groups_configuration": {
        "default_identity_domain_id"                              : "COMMON-DOMAIN",

        "groups": {
            "GRP-AUDITORS-ADMIN-KEY": {
                "description"                                     : "Tenancy global read access group(for security auditing or health checks).",
                "name"                                            : "grp-auditors-admin"
            },

            "GRP-COST-ADMIN-KEY": {
                "description"                                     : "Tenancy global cost control group.",
                "name"                                            : "grp-cost-admin"
            },

            "GRP-IAM-ADMIN-KEY": {
                "description"                                     : "Tenancy global Identity and access management administrator group.",
                "name"                                            : "grp-iam-admin"
            },

            "GRP-LZ-NETWORK-ADMIN-KEY": {
                "description"                                     : "One-OE Landing Zone, Shared network administration group, including common OE network elements.",
                "name"                                            : "grp-lz-network-admin"
            },

            "GRP-LZ-PREPROD-PROJ1-ADMIN-KEY": {
                "description"                                     : "One-OE Landing Zone, Pre-Production environment, Project 1, Administrators.",
                "name"                                            : "grp-lz-preprod-proj1-admin"
            },

            "GRP-LZ-PROD-PROJ1-ADMIN-KEY": {
                "description"                                     : "One-OE Landing Zone, Production environment, Project 1, Administrators.",
                "name"                                            : "grp-lz-prod-proj1-admin"
            },

            "GRP-LZ-SECURITY-ADMIN-KEY": {
                "description"                                     : "One-OE Landing Zone, Shared security administration group, including common OE network elements.",
                "name"                                            : "grp-lz-security-admin"
            },

            "GRP-SECURITY-ADMIN-KEY": {
                "description"                                     : "Tenancy Security Administrators for global resources as Cloud Guard.",
                "name"                                            : "grp-security-admin"
            }
        }
    },

    "identity_domains_configuration": {
        "default_compartment_id"                                  : null,
        "default_defined_tags"                                    : null,
        "default_freeform_tags"                                   : null,

        "identity_domains": {
            "COMMON-DOMAIN": {
                "admin_email"                                     : null,
                "admin_first_name"                                : null,
                "admin_last_name"                                 : null,
                "admin_user_name"                                 : null,
                "allow_signing_cert_public_access"                : false,
                "compartment_id"                                  : null,
                "description"                                     : "One-OE LZ common Identity Domain",
                "display_name"                                    : "id_lz_common",
                "home_region"                                     : null,
                "is_hidden_on_login"                              : false,
                "is_notification_bypassed"                        : false,
                "is_primary_email_required"                       : false,
                "license_type"                                    : "free",
                "replica_region"                                  : null
            }
        }
    },

    "policies_configuration": {
        "enable_cis_benchmark_checks"                             : "false",

        "supplied_policies": {
            "PCY-AUDITING-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Allow grp-auditors-admin group users to read all the resources in the tenancy.",
                "name"                                            : "pcy-auditing-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-auditors-admin' to inspect all-resources in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read instances in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read load-balancers in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read buckets in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read nat-gateways in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read public-ips in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read file-family in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read instance-configurations in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read network-security-groups in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read resource-availability in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read audit-events in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read users in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to use cloud-shell in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read vss-family in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read usage-budgets in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read usage-reports in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read data-safe-family in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read vaults in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read keys in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read tag-namespaces in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to read serviceconnectors in tenancy",
                    "allow group 'id_lz_common'/'grp-auditors-admin' to use ons-family in tenancy where any {request.operation!=/Create*/, request.operation!=/Update*/, request.operation!=/Delete*/, request.operation!=/Change*/}"
                ]
            },

            "PCY-COST-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Allow grp-cost-admin group users to manage all budget resources in the tenancy.",
                "name"                                            : "pcy-cost-admin",

                "statements": [
                    "define tenancy usage-report as ocid1.tenancy.oc1..aaaaaaaaned4fkpkisbwjlr56u7cj63lf3wffbilvqknstgtvzub7vhqkggq",
                    "endorse group 'id_lz_common'/'grp-cost-admin' to read objects in tenancy usage-report",
                    "allow group 'id_lz_common'/'grp-cost-admin' to manage usage-report in tenancy",
                    "allow group 'id_lz_common'/'grp-cost-admin' to manage usage-budgets in tenancy"
                ]
            },

            "PCY-GENERIC-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Allow defined groups to use generic services.",
                "name"                                            : "pcy-generic-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-iam-admin', 'id_lz_common'/'grp-auditors-admin', 'id_lz_common'/'grp-security-admin', 'id_lz_common'/'grp-lz-network-admin' to use cloud-shell in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin', 'id_lz_common'/'grp-auditors-admin', 'id_lz_common'/'grp-security-admin', 'id_lz_common'/'grp-lz-network-admin' to use cloud-shell-public-network in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin', 'id_lz_common'/'grp-auditors-admin', 'id_lz_common'/'grp-security-admin', 'id_lz_common'/'grp-lz-network-admin' to read usage-budgets in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin', 'id_lz_common'/'grp-auditors-admin', 'id_lz_common'/'grp-security-admin', 'id_lz_common'/'grp-lz-network-admin' to read usage-reports in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin', 'id_lz_common'/'grp-auditors-admin', 'id_lz_common'/'grp-security-admin', 'id_lz_common'/'grp-lz-network-admin' to read objectstorage-namespaces in tenancy",
                    "allow any-user to inspect tag-namespaces in tenancy where target.tag-namespace.name='tagns-lz-role'"
                ]
            },

            "PCY-IAM-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Allow grp-iam-admin group users to manage IAM resources in the tenancy.",
                "name"                                            : "pcy-iam-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage policies in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage users in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to inspect groups in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage groups in tenancy where all {target.group.name != 'Administrators'}",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage identity-providers in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage dynamic-groups in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage authentication-policies in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage network-sources in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage quota in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage tag-defaults in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage tag-namespaces in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage orm-jobs in tenancy",
                    "allow group 'id_lz_common'/'grp-iam-admin' to manage orm-config-source-providers in tenancy"
                ]
            },

            "PCY-LZ-NETWORK-ADMIN-KEY": {
                "compartment_id"                                  : "CMP-LANDINGZONE-KEY",
                "description"                                     : "Allow grp-lz-network-admin group users to manage all network resources in the child compartments of cmp-landingzone with the matching tags.",
                "name"                                            : "pcy-lz-network-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read all-resources in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage virtual-network-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage dns in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage load-balancers in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage alarms in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage metrics in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage orm-stacks in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage orm-jobs in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage orm-config-source-providers in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read audit-events in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read work-requests in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage instance-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage volume-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin')), request.permission != 'VOLUME_BACKUP_DELETE', request.permission != 'VOLUME_DELETE', request.permission != 'BOOT_VOLUME_BACKUP_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage object-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin')), request.permission != 'OBJECT_DELETE', request.permission != 'BUCKET_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage file-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin')), request.permission != 'FILE_SYSTEM_DELETE', request.permission != 'MOUNT_TARGET_DELETE', request.permission != 'EXPORT_SET_DELETE', request.permission != 'FILE_SYSTEM_DELETE_SNAPSHOT', request.permission != 'FILE_SYSTEM_NFSv3_UNEXPORT'}",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage bastion-session in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage cloudevents-rules in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read instance-agent-plugins in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage keys in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to use key-delegate in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage secret-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to manage repos in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read vss-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read ons-topics in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to use bastion in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to use bastion-session in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to use vaults in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-network-admin' to read logging-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))"
                ]
            },

            "PCY-LZ-PREPROD-PROJ1-ADMIN-KEY": {
                "compartment_id"                                  : "CMP-LZ-PREPROD-PROJ1-KEY",
                "description"                                     : "Allow grp-lz-preprod-proj1-admin group to manage their dedicated project 1 compartment",
                "name"                                            : "pcy-lz-preprod-proj1-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read all-resources in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read bucket in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to inspect object in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read audit-events in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read work-requests in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read instance-agent-plugins in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use network-security-groups in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use load-balancers in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use vnics in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use key-delegate in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage api-gateway-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage streams in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage cluster-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage alarms in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage metrics in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage logging-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage instance-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage volume-family in compartment cmp-lz-preprod-proj1 where all{request.permission != 'VOLUME_BACKUP_DELETE', request.permission != 'VOLUME_DELETE', request.permission != 'BOOT_VOLUME_BACKUP_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage object-family in compartment cmp-lz-preprod-proj1 where all{request.permission != 'OBJECT_DELETE', request.permission != 'BUCKET_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage file-family in compartment cmp-lz-preprod-proj1 where all{request.permission != 'FILE_SYSTEM_DELETE', request.permission != 'MOUNT_TARGET_DELETE', request.permission != 'EXPORT_SET_DELETE', request.permission != 'FILE_SYSTEM_DELETE_SNAPSHOT', request.permission != 'FILE_SYSTEM_NFSv3_UNEXPORT'}",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage repos in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage orm-stacks in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage orm-jobs in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage orm-config-source-providers in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage bastion-session in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage cloudevents-rules in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage keys in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage secret-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage database-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage autonomous-database-family in compartment cmp-lz-preprod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage data-safe-family in compartment cmp-lz-preprod-proj1"
                ]
            },

            "PCY-LZ-PREPROD-PROJ1-ADMIN-NET-KEY": {
                "compartment_id"                                  : "CMP-LZ-PREPROD-NETWORK-KEY",
                "description"                                     : "Allow grp-lz-preprod-proj1-admin group to use shared network resources",
                "name"                                            : "pcy-lz-preprod-proj1-admin-net",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use virtual-network-family in compartment cmp-lz-preprod-network",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use subnets in compartment cmp-lz-preprod-network",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use vnics in compartment cmp-lz-preprod-network",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage private-ips in compartment cmp-lz-preprod-network"
                ]
            },

            "PCY-LZ-PREPROD-PROJ1-ADMIN-SEC-KEY": {
                "compartment_id"                                  : "CMP-LZ-PREPROD-SECURITY-KEY",
                "description"                                     : "Allow grp-lz-preprod-proj1-admin group to use shared security resources",
                "name"                                            : "pcy-lz-preprod-proj1-admin-sec",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read ons-topics in compartment cmp-lz-preprod-security",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use vaults in compartment cmp-lz-preprod-security",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to manage instance-images in compartment cmp-lz-preprod-security",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use vss-family in compartment cmp-lz-preprod-security",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to use bastion in compartment cmp-lz-preprod-security",
                    "allow group 'id_lz_common'/'grp-lz-preprod-proj1-admin' to read logging-family in compartment cmp-lz-preprod-security"
                ]
            },

            "PCY-LZ-PROD-PLATFORM-OKE-ADMINS-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "allow grp-lz-prod-platform-oke-admins to manage OKE resources",
                "name"                                            : "pcy-lz-prod-platform-oke-admins",

                "statements": [
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to read all-resources in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to manage cluster-family in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to manage instance-family in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to use vnics in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to inspect compartments in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to read virtual-network-family in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-network",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to use subnets in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-network",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to use network-security-groups in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-network",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to use vnics in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-network",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-admins' to manage private-ips in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-network"
                ]
            },

            "PCY-LZ-PROD-PLATFORM-OKE-RBAC-ROLE-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "allow rbac roles to access OKE Prod Cluster",
                "name"                                            : "pcy-lz-prod-platform-oke-rbac-roles",

                "statements": [
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-rbac-admin' to use cluster in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke",
                    "Allow group 'id_lz_common'/'grp-lz-prod-platform-oke-rbac-viewer' to use cluster in compartment cmp-landingzone:cmp-lz-prod:cmp-lz-prod-platform:cmp-lz-prod-platform-oke"
                ]
            },

            "PCY-LZ-PROD-PLATFORM-OKE-VCN-CNI-KEY": {
                "//"                                              : "This is potentially unsafe as it can be used for privilige escalation across environments. See https://docs.oracle.com/en-us/iaas/Content/ContEng/Concepts/contengpodnetworking_topic-OCI_CNI_plugin.htm for restricting permissions.",
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "(unsafe) Grant OKE clusters tenancy wide permissions to use resource",
                "name"                                            : "pcy-lz-prod-platform-oke-vcn-cni",

                "statements": [
                    "allow any-user to manage instances in tenancy where all { request.principal.type = 'cluster'}",
                    "allow any-user to use private-ips in tenancy where all { request.principal.type = 'cluster'}",
                    "allow any-user to use network-security-groups in tenancy where all { request.principal.type = 'cluster'}"
                ]
            },

            "PCY-LZ-PROD-PROJ1-ADMIN-KEY": {
                "compartment_id"                                  : "CMP-LZ-PROD-PROJ1-KEY",
                "description"                                     : "Allow grp-lz-prod-proj1-admin group to manage their dedicated project 1 compartment",
                "name"                                            : "pcy-lz-prod-proj1-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read all-resources in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read bucket in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to inspect object in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read audit-events in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read work-requests in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read instance-agent-plugins in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use network-security-groups in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use load-balancers in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use vnics in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use key-delegate in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage api-gateway-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage streams in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage cluster-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage alarms in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage metrics in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage logging-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage instance-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage volume-family in compartment cmp-lz-prod-proj1 where all{request.permission != 'VOLUME_BACKUP_DELETE', request.permission != 'VOLUME_DELETE', request.permission != 'BOOT_VOLUME_BACKUP_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage object-family in compartment cmp-lz-prod-proj1 where all{request.permission != 'OBJECT_DELETE', request.permission != 'BUCKET_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage file-family in compartment cmp-lz-prod-proj1 where all{request.permission != 'FILE_SYSTEM_DELETE', request.permission != 'MOUNT_TARGET_DELETE', request.permission != 'EXPORT_SET_DELETE', request.permission != 'FILE_SYSTEM_DELETE_SNAPSHOT', request.permission != 'FILE_SYSTEM_NFSv3_UNEXPORT'}",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage repos in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage orm-stacks in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage orm-jobs in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage orm-config-source-providers in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage bastion-session in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage cloudevents-rules in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage keys in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage secret-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage database-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage autonomous-database-family in compartment cmp-lz-prod-proj1",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage data-safe-family in compartment cmp-lz-prod-proj1"
                ]
            },

            "PCY-LZ-PROD-PROJ1-ADMIN-NET-KEY": {
                "compartment_id"                                  : "CMP-LZ-PROD-NETWORK-KEY",
                "description"                                     : "Allow grp-lz-prod-proj1-admin group to use shared network resources",
                "name"                                            : "pcy-lz-prod-proj1-admin-net",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use virtual-network-family in compartment cmp-lz-prod-network",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use subnets in compartment cmp-lz-prod-network",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use vnics in compartment cmp-lz-prod-network",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage private-ips in compartment cmp-lz-prod-network"
                ]
            },

            "PCY-LZ-PROD-PROJ1-ADMIN-SEC-KEY": {
                "compartment_id"                                  : "CMP-LZ-PROD-SECURITY-KEY",
                "description"                                     : "Allow grp-lz-prod-proj1-admin group to use shared security resources",
                "name"                                            : "pcy-lz-prod-proj1-admin-sec",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read ons-topics in compartment cmp-lz-prod-security",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use vaults in compartment cmp-lz-prod-security",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to manage instance-images in compartment cmp-lz-prod-security",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use vss-family in compartment cmp-lz-prod-security",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to use bastion in compartment cmp-lz-prod-security",
                    "allow group 'id_lz_common'/'grp-lz-prod-proj1-admin' to read logging-family in compartment cmp-lz-prod-security"
                ]
            },

            "PCY-LZ-SECURITY-ADMIN-KEY": {
                "compartment_id"                                  : "CMP-LANDINGZONE-KEY",
                "description"                                     : "Allow grp-security-admin group users to manage all security resources in the child compartments of cmp-landingzone with the matching tags.",
                "name"                                            : "pcy-lz-security-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage tag-namespaces in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage tag-defaults in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage repos in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read audit-events in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read app-catalog-listing in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read instance-images in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to inspect buckets in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read all-resources in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage instance-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage volume-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin')), request.permission != 'VOLUME_BACKUP_DELETE', request.permission != 'VOLUME_DELETE', request.permission != 'BOOT_VOLUME_BACKUP_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage object-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin')), request.permission != 'OBJECT_DELETE', request.permission != 'BUCKET_DELETE'}",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage file-family in compartment cmp-landingzone where all{sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin')), request.permission != 'FILE_SYSTEM_DELETE', request.permission != 'MOUNT_TARGET_DELETE', request.permission != 'EXPORT_SET_DELETE', request.permission != 'FILE_SYSTEM_DELETE_SNAPSHOT', request.permission != 'FILE_SYSTEM_NFSv3_UNEXPORT'}",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage vaults in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage keys in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage secret-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage logging-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage serviceconnectors in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage streams in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage ons-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage functions-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage waas-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage security-zone in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage orm-stacks in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage orm-jobs in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage orm-config-source-providers in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage vss-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read work-requests in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage bastion-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read instance-agent-plugins in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage cloudevents-rules in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage alarms in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage metrics in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to use key-delegate in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read virtual-network-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to use subnets in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to use network-security-groups in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to use vnics in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage private-ips in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to read keys in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-network-admin'))",
                    "allow group 'id_lz_common'/'grp-lz-security-admin' to manage operator-control-family in compartment cmp-landingzone where sets-intersect(target.resource.compartment.tag.tagns-lz-role.tag-lz-role, ('lz-security-admin'))"
                ]
            },

            "PCY-SECURITY-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Allow grp-security-admin group users to manage all security resources in the security compartment.",
                "name"                                            : "pcy-security-admin",

                "statements": [
                    "allow group 'id_lz_common'/'grp-security-admin' to manage cloudevents-rules in tenancy",
                    "allow group 'id_lz_common'/'grp-security-admin' to manage cloud-guard-family in tenancy",
                    "allow group 'id_lz_common'/'grp-security-admin' to read tenancies in tenancy"
                ]
            },

            "PCY-SERVICES-ADMIN-KEY": {
                "compartment_id"                                  : "TENANCY-ROOT",
                "description"                                     : "Policy for all supported services in the tenancy.",
                "name"                                            : "pcy-services-admin",

                "statements": [
                    "allow service cloudguard to manage cloudevents-rules in tenancy where target.rule.type='managed'",
                    "allow service cloudguard to read tenancies in tenancy",
                    "allow service cloudguard to read all-resources in tenancy",
                    "allow service cloudguard to use network-security-groups in tenancy",
                    "allow any-user to { WLP_BOM_READ, WLP_CONFIG_READ } in tenancy where all { request.principal.id = target.agent.id, request.principal.type = 'workloadprotectionagent'}",
                    "endorse any-user to { WLP_LOG_CREATE, WLP_METRICS_CREATE, WLP_ADHOC_QUERY_READ, WLP_ADHOC_RESULTS_CREATE } in any-tenancy where all { request.principal.id = target.agent.id, request.principal.type = 'workloadprotectionagent' }",
                    "allow service vulnerability-scanning-service to manage instances in tenancy",
                    "allow service vulnerability-scanning-service to read compartments in tenancy",
                    "allow service vulnerability-scanning-service to read repos in tenancy",
                    "allow service vulnerability-scanning-service to read vnics in tenancy",
                    "allow service vulnerability-scanning-service to read vnic-attachments in tenancy",
                    "allow service osms to read instances in tenancy",
                    "allow service blockstorage, oke, streaming, Fssoc1Prod, objectstorage-eu-frankfurt-1 to use keys in tenancy"
                ]
            }
        }
    }
}
